<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>PCR Predict</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet"/>
  <style>
    html { scroll-behavior: smooth; }
    body { font-family: 'Inter', sans-serif; }
    th, td { border: 1px solid #e5e7eb; }
  </style>
</head>
<body class="bg-gray-50 text-gray-900">

  <!-- Header -->
  <header class="flex items-center px-6 py-4 text-sm font-normal text-gray-700">
    <img alt="PCR Predict logo" class="mr-2" height="20" src="https://storage.googleapis.com/a1aa/image/a82c4f64-fd1f-40f6-6b18-b503ea7a7574.jpg" width="20"/>
    <span>PCR Predict</span>
  </header>

  <main class="max-w-3xl mx-auto px-6 pb-12">

    <!-- Title -->
    <section class="text-center mt-2 mb-10">
      <h1 class="text-lg sm:text-xl font-semibold text-gray-900 leading-tight">
        Prediksi Keterlambatan Studi Mahasiswa<br/>Politeknik Caltex Riau
      </h1>
      <p class="mt-1 text-xs sm:text-sm text-gray-500 font-normal max-w-[400px] mx-auto leading-snug">
        Platform prediksi yang membantu mengidentifikasi potensi keterlambatan studi mahasiswa menggunakan algoritma machine learning
      </p>
    </section>

    <!-- Buttons -->
    <section class="flex flex-col sm:flex-row justify-center gap-6 mb-8">
      <div class="bg-white rounded-md shadow-sm border border-gray-200 w-full sm:w-1/2 max-w-xs p-5 flex flex-col items-center text-center">
        <img alt="Manual input icon" class="mb-3" height="24" src="https://storage.googleapis.com/a1aa/image/cce4bae9-0b66-48b2-69fc-0232377e30b6.jpg" width="24"/>
        <h2 class="font-semibold text-gray-900 mb-1 text-sm">Input Manual</h2>
        <p class="text-xs text-gray-500 mb-4 leading-tight">
          Masukkan data mahasiswa secara manual melalui form yang tersedia
        </p>
        <button onclick="document.getElementById('formManual').scrollIntoView({behavior: 'smooth'});" class="bg-gray-900 text-white text-xs font-semibold rounded px-4 py-2 w-full max-w-[140px]" type="button">
          Input Manual
        </button>
      </div>
      <div class="bg-white rounded-md shadow-sm border border-gray-200 w-full sm:w-1/2 max-w-xs p-5 flex flex-col items-center text-center">
        <img alt="Upload file icon" class="mb-3" height="24" src="https://storage.googleapis.com/a1aa/image/a1bcc244-4e12-44d3-107b-a4d70eade82d.jpg" width="24"/>
        <h2 class="font-semibold text-gray-900 mb-1 text-sm">Input File</h2>
        <p class="text-xs text-gray-500 mb-4 leading-tight">
          Upload file Excel atau CSV yang berisi data mahasiswa
        </p>
        <button onclick="document.getElementById('formUpload').scrollIntoView({behavior: 'smooth'});" class="bg-gray-900 text-white text-xs font-semibold rounded px-4 py-2 w-full max-w-[140px]" type="button">
          Upload File
        </button>
      </div>
    </section>

    <!-- Petunjuk -->
    <section class="bg-white border border-gray-200 rounded-md p-4 mb-10 max-w-3xl mx-auto text-xs text-gray-600 leading-tight">
      <ul class="list-disc list-inside space-y-1">
        <li>Pilih metode input data sesuai kebutuhan Anda</li>
        <li>Untuk input manual, isi semua field yang diperlukan pada form</li>
        <li>Untuk upload file, pastikan format file sesuai dengan template yang disediakan</li>
      </ul>
    </section>

    <!-- Form Manual -->
    <section id="formManual" class="mb-12 max-w-3xl mx-auto bg-white border border-gray-200 rounded-md p-6">
  <h3 class="text-gray-900 font-semibold mb-4 text-sm">Form Input Data Mahasiswa</h3>
  <form class="space-y-4 text-xs text-gray-700" method="POST">
    <div>
      <label class="block mb-1 font-normal" for="nama">Nama Mahasiswa</label>
      <input class="w-full border border-gray-200 rounded px-3 py-2" id="nama" name="nama" required type="text"/>
    </div>
    <div>
      <label class="block mb-1 font-normal" for="nim">NIM</label>
      <input class="w-full border border-gray-200 rounded px-3 py-2" id="nim" name="nim" required type="text"/>
    </div>
    <div>
      <label class="block mb-1 font-normal" for="tahun_masuk">Tahun Masuk</label>
      <select class="w-full border border-gray-200 rounded px-3 py-2" name="tahun_masuk" required>
        <option value="2019">2019</option>
        <option value="2020">2020</option>
        <option value="2021">2021</option>
        <option value="2022">2022</option>
        <option value="2023">2023</option>
        <option value="2024">2024</option>
      </select>
    </div>
    <div>
      <label class="block mb-1 font-normal" for="prodi">Program Studi</label>
      <select class="w-full border border-gray-200 rounded px-3 py-2" name="prodi" required>
        <option value="TET">TET</option>
        <option value="TL">TL</option>
        <option value="TRSE">TRSE</option>
        <option value="TE">TE</option>
        <option value="TT">TT</option>
        <option value="TMS">TMS</option>
        <option value="TRM">TRM</option>
        <option value="TM">TM</option>
        <option value="TI">TI</option>
        <option value="TRK">TRK</option>
        <option value="TK">TK</option>
        <option value="SI">SI</option>
        <option value="Akt">Akt</option>
        <option value="TRJT">TRJT</option>
        <option value="AktP">AktP</option>
        <option value="MTTK">MTTK</option>
        <option value="BD">BD</option>
        <option value="HMKD">HMKD</option>
      </select>
    </div>
    <div>
      <label class="block mb-1 font-normal" for="jalur_masuk">Jalur Masuk</label>
      <select class="w-full border border-gray-200 rounded px-3 py-2" name="jalur_masuk" required>
        <option value="PSUD">PSUD</option>
        <option value="UMPCR I">UMPCR I</option>
        <option value="CBT Bersama I">CBT Bersama I</option>
        <option value="UMPCR III">UMPCR III</option>
        <option value="UMPCR II">UMPCR II</option>
        <option value="Jalur Kerjasama LLDIKTI X">Jalur Kerjasama LLDIKTI X</option>
        <option value="TOL">TOL</option>
        <option value="Jalur Khusus">Jalur Khusus</option>
        <option value="Alih Jenjang D3">Alih Jenjang D3</option>
        <option value="Jalur Fast Track">Jalur Fast Track</option>
        <option value="Beasiswa">Beasiswa</option>
        <option value="Magister Reguler">Magister Reguler</option>
      </select>
    </div>
    <div>
      <label class="block mb-1 font-normal" for="jenis_kelamin">Jenis Kelamin</label>
      <select class="w-full border border-gray-200 rounded px-3 py-2" name="jenis_kelamin" required>
        <option value="L">Laki-laki</option>
        <option value="P">Perempuan</option>
      </select>
    </div>
    <div>
      <label class="block mb-1 font-normal">Menerima KPS</label>
      <select class="w-full border border-gray-200 rounded px-3 py-2" name="terima_kps" required>
        <option value="Ya">Ya</option>
        <option value="Tidak">Tidak</option>
      </select>
    </div>

    <!-- Form Tambahan (IPS, TAK, CO) -->
    <div>
      <label class="block mb-1 font-normal" for="total_tak">Total TAK</label>
      <input class="w-full border border-gray-200 rounded px-3 py-2" id="total_tak" name="total_tak" required type="number"/>
    </div>
    <div>
      <label class="block mb-1 font-normal" for="jumlah_co">Jumlah CO</label>
      <input class="w-full border border-gray-200 rounded px-3 py-2" id="jumlah_co" name="jumlah_co" required type="number"/>
    </div>
    <div>
      <label class="block mb-1 font-normal" for="IPS1">IPS Semester 1</label>
      <input class="w-full border border-gray-200 rounded px-3 py-2" id="IPS1" name="IPS1" required type="number" step="0.01"/>
    </div>
    <div>
      <label class="block mb-1 font-normal" for="IPS2">IPS Semester 2</label>
      <input class="w-full border border-gray-200 rounded px-3 py-2" id="IPS2" name="IPS2" required type="number" step="0.01"/>
    </div>
    <div>
      <label class="block mb-1 font-normal" for="IPS3">IPS Semester 3</label>
      <input class="w-full border border-gray-200 rounded px-3 py-2" id="IPS3" name="IPS3" required type="number" step="0.01"/>
    </div>
    <div>
      <label class="block mb-1 font-normal" for="IPS4">IPS Semester 4</label>
      <input class="w-full border border-gray-200 rounded px-3 py-2" id="IPS4" name="IPS4" required type="number" step="0.01"/>
    </div>
    <div>
      <label class="block mb-1 font-normal" for="IPS5">IPS Semester 5</label>
      <input class="w-full border border-gray-200 rounded px-3 py-2" id="IPS5" name="IPS5" required type="number" step="0.01"/>
    </div>

    <button class="bg-gray-900 text-white text-xs font-semibold rounded w-full py-2 mt-2" type="submit">Submit Data</button>
  </form>
</section>


    <!-- Upload File Section -->
    <section id="formUpload" class="mb-12 bg-white border border-gray-200 rounded-md p-6">
      <h3 class="text-gray-900 font-semibold mb-4 text-sm">Upload File CSV</h3>
      <form class="space-y-4 text-xs text-gray-700" method="POST" enctype="multipart/form-data">
        <div>
          <label class="block mb-1 font-normal" for="file">Pilih file CSV</label>
          <input class="w-full border border-gray-200 rounded px-3 py-2" id="file" name="file" required type="file" accept=".csv"/>
        </div>
        <button class="bg-gray-900 text-white text-xs font-semibold rounded w-full py-2 mt-2" type="submit">Upload File</button>
      </form>
    </section>

    <!-- Hasil Prediksi Manual -->
    {% if manual_result %}
<section class="mt-8">
  <h4 class="text-xs font-normal text-gray-900 mb-2">Hasil Prediksi (Input Manual)</h4>

  <div class="overflow-x-auto border border-gray-300 rounded-md">
    <table class="min-w-full text-xs text-left text-gray-700">
      <thead class="bg-gray-100 sticky top-0">
        <tr>
          {% for key in manual_result.keys() %}
          <th class="px-3 py-2 border-b border-gray-300 font-semibold">{{ key }}</th>
          {% endfor %}
        </tr>
      </thead>
      <tbody>
        <tr class="border-b border-gray-200 hover:bg-gray-50">
          {% for value in manual_result.values() %}
          <td class="px-3 py-2 whitespace-nowrap">{{ value }}</td>
          {% endfor %}
        </tr>
      </tbody>
    </table>
  </div>
</section>
{% endif %}


    <!-- Hasil Prediksi Batch -->
    {% if batch_result is not none and not batch_result.empty %}
    <section class="mt-8">
      <h4 class="text-xs font-normal text-gray-900 mb-2">Hasil Prediksi (Batch Upload)</h4>

      <!-- Pagination Controls -->
      <div class="flex justify-between items-center mb-2 text-xs">
        <button id="prevPage" class="bg-gray-300 text-gray-700 px-3 py-1 rounded">Previous</button>
        <span id="pageInfo">Page 1</span>
        <button id="nextPage" class="bg-gray-300 text-gray-700 px-3 py-1 rounded">Next</button>
      </div>

      <!-- Scrollable Table -->
      <div class="overflow-x-auto border border-gray-300 rounded-md" style="max-height: 500px; overflow-y: auto;">
        <table id="resultTable" class="min-w-full text-xs text-left text-gray-700">
          <thead class="bg-gray-100 sticky top-0">
            <tr>
              {% for col in batch_result.columns %}
              <th class="px-3 py-2 border-b border-gray-300 font-semibold">{{ col }}</th>
              {% endfor %}
            </tr>
          </thead>
          <tbody id="tableBody">
            {% for row in batch_result.itertuples(index=False) %}
            <tr class="border-b border-gray-200 hover:bg-gray-50">
              {% for value in row %}
              <td class="px-3 py-2 whitespace-nowrap">{{ value }}</td>
              {% endfor %}
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <!-- Download Button -->
      <div class="mt-4 text-center">
        <a href="/download" class="bg-gray-900 text-white text-xs font-semibold rounded px-4 py-2">Download Hasil Prediksi</a>
      </div>
    </section>
    {% endif %}

  </main>

  <footer class="bg-gray-900 text-gray-300 text-center text-xs py-3 mt-12">
    © 2025 PCR Predict. Hak Cipta Dilindungi.
  </footer>

  <!-- Pagination Script -->
  <script>
    const rowsPerPage = 50;
    const table = document.getElementById('resultTable');
    const tbody = document.getElementById('tableBody');
    const rows = Array.from(tbody.getElementsByTagName('tr'));
    let currentPage = 1;
    const totalPages = Math.ceil(rows.length / rowsPerPage);
    const pageInfo = document.getElementById('pageInfo');
    const prevBtn = document.getElementById('prevPage');
    const nextBtn = document.getElementById('nextPage');

    function renderTable() {
      tbody.innerHTML = '';
      const start = (currentPage - 1) * rowsPerPage;
      const end = start + rowsPerPage;
      const pageRows = rows.slice(start, end);
      pageRows.forEach(row => tbody.appendChild(row));
      pageInfo.textContent = `Page ${currentPage} of ${totalPages}`;
      prevBtn.disabled = currentPage === 1;
      nextBtn.disabled = currentPage === totalPages;
    }

    prevBtn.addEventListener('click', () => {
      if (currentPage > 1) {
        currentPage--;
        renderTable();
      }
    });

    nextBtn.addEventListener('click', () => {
      if (currentPage < totalPages) {
        currentPage++;
        renderTable();
      }
    });

    renderTable();
  </script>

</body>
</html>